/* ==========================================================================
   DARK MODE STYLES
   ========================================================================== */

@media (prefers-color-scheme: dark) {
  /* Base colors - use !important to override Chrome's automatic dark mode */
  html {
    background-color: #1a1a1a !important;
    color-scheme: dark;
  }

  body {
    background-color: #1a1a1a !important;
    color: #e5e7eb !important;
  }

  /* Ensure all wrapper elements have dark backgrounds */
  #main,
  .page,
  .page__inner-wrap {
    background-color: transparent !important;
  }

  /* Text colors - use !important to ensure they override base styles */
  h1, h2, h3, h4, h5, h6 {
    color: #f3f4f6 !important;
  }

  p, li, dl, dt, dd, span, div {
    color: #e5e7eb !important;
  }

  small, .small {
    color: #d1d5db !important;
  }

  /* Ensure all text elements are visible */
  strong, b, em, i {
    color: inherit !important;
  }

  /* Links - ensure they're visible and have good contrast */
  a {
    color: #60a5fa !important;

    &:hover,
    &:active {
      color: #93c5fd !important;
    }

    &:visited {
      color: #a78bfa !important;
    }

    &:focus {
      outline-color: #60a5fa !important;
    }
  }

  /* Borders and dividers */
  hr {
    border-top-color: #374151;
  }

  /* Blockquotes */
  blockquote {
    border-left-color: #60a5fa !important;
    color: #d1d5db !important;

    cite {
      color: #9ca3af !important;
    }
  }

  /* Code */
  code, kbd, samp, pre {
    background-color: #2d2d2d !important;
    color: #e5e7eb !important;
  }

  p > code,
  a > code,
  li > code,
  figcaption > code,
  td > code {
    background-color: #2d2d2d !important;
    border-color: #4b5563 !important;
    color: #e5e7eb !important;
  }

  /* Syntax highlighting */
  div.highlighter-rouge,
  figure.highlight {
    background-color: #1e1e1e;
    border-color: #374151;

    &:before {
      background-color: #2d2d2d;
      color: #9ca3af;
    }
  }

  /* Masthead */
  .masthead {
    background-color: #1a1a1a !important;
    border-bottom-color: #374151 !important;

    a {
      color: #e5e7eb !important;

      &:hover {
        color: #f3f4f6 !important;
      }
    }
  }

  /* Navigation */
  .masthead__menu-item {
    a {
      color: #e5e7eb !important;

      &:hover {
        color: #f3f4f6 !important;
      }
    }
  }

  /* Greedy navigation */
  .greedy-nav {
    background: #1a1a1a !important;

    a {
      color: #e5e7eb !important;

      &:hover {
        color: #f3f4f6 !important;
      }
    }

    button {
      background-color: #374151 !important;
      color: #e5e7eb !important;
    }

    .visible-links {
      a {
        &:before {
          background: #60a5fa !important;
        }
      }
    }

    .hidden-links {
      background: #2d2d2d !important;
      border-color: #4b5563 !important;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.5) !important;

      a {
        color: #e5e7eb !important;

        &:hover {
          color: #f3f4f6 !important;
          background: #374151 !important;
        }
      }

      &:before {
        border-color: #4b5563 transparent !important;
      }

      &:after {
        border-color: #2d2d2d transparent !important;
      }
    }
  }

  /* Page content */
  .page__content {
    h2 {
      border-bottom-color: #374151 !important;
      color: #f3f4f6 !important;
    }

    a {
      color: #60a5fa !important;

      &:hover {
        color: #93c5fd !important;
      }
    }
  }

  .page__title {
    color: #f3f4f6 !important;
  }

  .page__lead {
    color: #d1d5db !important;
  }

  .page__meta {
    color: #9ca3af !important;

    a {
      color: #9ca3af !important;

      &:hover {
        color: #d1d5db !important;
      }
    }
  }

  .page__share {
    border-top-color: #374151;
  }

  .page__share-title {
    color: #d1d5db;
  }

  .page__taxonomy-item {
    background-color: #2d2d2d;
    border-color: #4b5563;
    color: #e5e7eb;

    &:hover {
      background-color: #374151;
      border-color: #60a5fa;
      color: #60a5fa;
    }
  }

  .page__comments-title {
    border-top-color: #374151;
    color: #d1d5db;
  }

  .page__comments-form {
    background-color: #2d2d2d;
    border-color: #4b5563;
  }

  .page__related {
    border-top-color: #374151;
  }

  .page__related-title {
    color: #d1d5db;
  }

  /* Footer */
  .page__footer {
    background-color: #1a1a1a !important;
    border-top-color: #374151 !important;
    color: #9ca3af !important;

    a {
      color: #9ca3af !important;

      &:hover {
        color: #d1d5db !important;
      }
    }

    .fas,
    .fab,
    .far,
    .fal {
      color: #9ca3af !important;
    }
  }

  /* Figures and images */
  figcaption {
    color: #9ca3af;

    a {
      color: #9ca3af;
      border-bottom-color: #4b5563;

      &:hover {
        color: #d1d5db;
        border-bottom-color: #60a5fa;
      }
    }
  }

  /* Abbreviations */
  abbr[title],
  abbr[data-original-title] {
    border-bottom-color: #4b5563;
  }

  /* Underline and insert */
  u, ins {
    border-bottom-color: #4b5563;
  }

  /* Archive */
  .archive__subtitle {
    border-bottom-color: #374151 !important;
    color: #9ca3af !important;
  }

  .archive__item-title {
    a {
      color: #f3f4f6 !important;

      &:hover {
        color: #60a5fa !important;
      }
    }
  }

  .archive__item-excerpt {
    color: #d1d5db !important;
  }

  .archive__item {
    color: #e5e7eb !important;

    &:hover {
      .archive__item-teaser {
        box-shadow: 0 0 10px rgba(96, 165, 250, 0.3);
      }
    }
  }

  .feature__wrapper {
    border-bottom-color: #374151;
  }

  /* Buttons */
  .btn {
    background-color: #374151;
    border-color: #4b5563;
    color: #e5e7eb;

    &:hover {
      background-color: #4b5563;
      border-color: #60a5fa;
      color: #f3f4f6;
    }

    &--primary {
      background-color: #2563eb;
      border-color: #3b82f6;
      color: #ffffff;

      &:hover {
        background-color: #3b82f6;
        border-color: #60a5fa;
      }
    }

    &--success {
      background-color: #059669;
      border-color: #10b981;
      color: #ffffff;

      &:hover {
        background-color: #10b981;
      }
    }

    &--warning {
      background-color: #d97706;
      border-color: #f59e0b;
      color: #ffffff;

      &:hover {
        background-color: #f59e0b;
      }
    }

    &--danger {
      background-color: #dc2626;
      border-color: #ef4444;
      color: #ffffff;

      &:hover {
        background-color: #ef4444;
      }
    }

    &--info {
      background-color: #0891b2;
      border-color: #06b6d4;
      color: #ffffff;

      &:hover {
        background-color: #06b6d4;
      }
    }
  }

  /* Notices - override inline styles */
  .notice {
    background: linear-gradient(135deg, #0f172a 0%, #0b1021 100%) !important;
    border-color: #4b5563 !important;
    color: #e5e7eb !important;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.35) !important;

    /* Override any inline color styles */
    &[style*="color"] {
      color: #e5e7eb !important;
    }

    /* Override background gradients in inline styles */
    &[style*="background"] {
      background: linear-gradient(135deg, #0f172a 0%, #0b1021 100%) !important;
    }

    h2, h3, h4 {
      color: #f3f4f6 !important;
    }

    /* Override inline h2 styles - catch all variations */
    h2[style*="color"] {
      color: #eef2ff !important;
    }

    /* Specific override for Publications h2 */
    h2[style*="0f2167"] {
      color: #eef2ff !important;
    }

    a {
      color: #60a5fa !important;

      &:hover {
        color: #93c5fd !important;
      }
    }

    code {
      background-color: #1a1a1a !important;
      border-color: #374151 !important;
    }

    /* Override inline span colors - catch all variations */
    span {
      &[style*="color:#333"],
      &[style*="color: #333"],
      &[style*="color:#333;"],
      &[style*="color: #333;"],
      &[style*="color:#0f2167"],
      &[style*="color: #0f2167"],
      &[style*="color:#0f2167;"],
      &[style*="color: #0f2167;"] {
        color: #d1d5db !important;
      }
    }

    /* Publication links */
    .publication-link {
      color: #93c5fd !important;

      &:hover {
        color: #ffffff !important;
        background-color: #3b82f6 !important;
      }
    }

    /* Override inline link colors - catch all variations */
    a {
      &[style*="color:#0066cc"],
      &[style*="color: #0066cc"],
      &[style*="color:#0066cc;"],
      &[style*="color: #0066cc;"] {
        color: #60a5fa !important;
      }
    }

    /* Override hr borders */
    hr {
      &[style*="border-top"],
      &[style*="border-top:"] {
        border-top-color: #4b5563 !important;
      }
    }
  }

  .notice--primary {
    background-color: rgba(37, 99, 235, 0.15);
    border-color: #3b82f6;
    color: #e5e7eb;

    a {
      color: #93c5fd;
    }
  }

  .notice--info {
    background-color: rgba(8, 145, 178, 0.15);
    border-color: #06b6d4;
    color: #e5e7eb;

    a {
      color: #67e8f9;
    }
  }

  .notice--warning {
    background-color: rgba(217, 119, 6, 0.15);
    border-color: #f59e0b;
    color: #e5e7eb;

    a {
      color: #fbbf24;
    }
  }

  .notice--success {
    background-color: rgba(5, 150, 105, 0.15);
    border-color: #10b981;
    color: #e5e7eb;

    a {
      color: #34d399;
    }
  }

  .notice--danger {
    background-color: rgba(220, 38, 38, 0.15);
    border-color: #ef4444;
    color: #e5e7eb;

    a {
      color: #f87171;
    }
  }

  /* Forms */
  input[type="text"],
  input[type="email"],
  input[type="url"],
  input[type="password"],
  input[type="search"],
  textarea,
  select {
    background-color: #2d2d2d;
    border-color: #4b5563;
    color: #e5e7eb;

    &:focus {
      border-color: #60a5fa;
      background-color: #1a1a1a;
    }
  }

  label {
    color: #d1d5db;
  }

  /* Tables */
  table {
    color: #e5e7eb;

    th {
      background-color: #2d2d2d;
      border-color: #4b5563;
      color: #f3f4f6;
    }

    td {
      border-color: #374151;
    }

    tr:nth-child(even) {
      background-color: #2d2d2d;
    }
  }

  /* Sidebar */
  .sidebar {
    background-color: #1a1a1a !important;
    border-color: #374151 !important;
    color: #e5e7eb !important;

    a {
      color: #e5e7eb !important;

      &:hover {
        color: #60a5fa !important;
      }
    }
  }

  /* Comments */
  .comment {
    border-bottom-color: #374151;

    &__author {
      a {
        color: #f3f4f6;
      }
    }

    &__avatar {
      border-color: #4b5563;
    }
  }

  /* Page hero */
  .page__hero-caption {
    background-color: rgba(0, 0, 0, 0.7);
    color: #ffffff;
  }

  /* Main container */
  #main {
    background-color: transparent !important;
  }

  /* Ensure all content areas are readable */
  .page__content,
  .archive,
  .entry-content {
    color: #e5e7eb !important;

    * {
      color: inherit;
    }
  }

  /* Override any white backgrounds that might make text invisible */
  .lighter-gray,
  .light-gray {
    background-color: #2d2d2d !important;
    color: #e5e7eb !important;
  }

  /* Ensure selection is visible */
  ::selection {
    background-color: #3b82f6 !important;
    color: #ffffff !important;
  }

  ::-moz-selection {
    background-color: #3b82f6 !important;
    color: #ffffff !important;
  }

  /* Catch-all: ensure any unstyled elements are readable */
  * {
    &[style*="color"] {
      /* Don't override inline styles, but ensure they're visible */
    }
  }

  /* Ensure all text in common containers is visible */
  article,
  section,
  aside,
  nav,
  main,
  header,
  footer {
    color: inherit;
  }

  /* Override any potential white text on dark backgrounds */
  .text-white,
  .white-text {
    color: #e5e7eb !important;
  }

  /* Ensure buttons and interactive elements are visible */
  button,
  .button {
    color: #e5e7eb !important;
  }

  /* Override inline styles in divs and spans - catch all variations */
  div, span {
    &[style*="color:#333"],
    &[style*="color: #333"],
    &[style*="color:#333;"],
    &[style*="color: #333;"] {
      color: #d1d5db !important;
    }

    &[style*="color:#0f2167"],
    &[style*="color: #0f2167"],
    &[style*="color:#0f2167;"],
    &[style*="color: #0f2167;"] {
      color: #eef2ff !important;
    }
  }

  h2 {
    &[style*="color:#0f2167"],
    &[style*="color: #0f2167"],
    &[style*="color:#0f2167;"],
    &[style*="color: #0f2167;"] {
      color: #eef2ff !important;
    }
  }

  /* About page specific styles */
  .about-title {
    color: #eef2ff !important;
  }

  .about-subtle {
    color: #cbd5e1 !important;
  }

  .chip {
    background: rgba(59, 130, 246, 0.12) !important;
    color: #cfe0ff !important;
    border-color: rgba(59, 130, 246, 0.25) !important;
  }

  .edu {
    background: rgba(59, 130, 246, 0.10) !important;
    border-color: #334155 !important;

    h3 {
      color: #e5e7eb !important;
    }

    .label {
      color: #cbd5e1 !important;
    }

    .degree {
      color: #9ec1ff !important;
    }
  }

  .cta-row a {
    background: rgba(59, 130, 246, 0.12) !important;
    color: #dbeafe !important;
    border-color: rgba(59, 130, 246, 0.25) !important;
  }

  .disclaimer {
    background: rgba(148, 163, 184, 0.12) !important;
    color: #e5e7eb !important;
    border-left-color: #64748b !important;
  }
}

